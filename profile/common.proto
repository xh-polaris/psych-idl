syntax = "proto3";

package model;

option go_package = "profile";

import "basic/re.proto";
import "basic/pagination.proto";
import "google/protobuf/any.proto";

/* User */
message User {
  string id = 1;
  string codeType = 2;
  string code = 3;
  string password = 4;
  string unitId = 5;
  string name = 6;
  int64 birth = 7;
  string gender = 8;
  string status = 9;
  int32 enrollYear = 10;
  int32 grade = 11;
  int32 class = 12;
  map<string, google.protobuf.Any> options = 13;
  int64 createTime = 14;
  int64 updateTime = 15;
  int64 deleteTime = 16;
}

// 注册相关
message UserSignUpReq {
  User user = 1;
}
message UserSignUpResp {
  User user = 1;
}

// 登录相关，支持弱校验
message UserSignInReq {
  string unitId = 1;
  string authType = 2;
  string authId = 3;
  string authValue = 4;
}
message UserSignInResp {
  string unitId = 1;
  string userId = 2;
  bool strong = 3;
}

// 获取信息
message UserGetInfoReq {
  string userId = 1;
}
message UserGetInfoResp {
  User user = 1;
}

// 更新信息
message UserUpdateInfoReq {
  User user = 1;
}

// 更新密码
message UserUpdatePasswordReq {
  string id = 1;
  string authType = 2;
  string authValue = 3;
  string newPassword = 4;
}

/* Unit */
message Unit {
  string id = 1;
  string phone = 2;
  string password = 3;
  string name = 4;
  string address = 5;
  string contact = 6;
  int32 level = 7;
  string status = 8;
  int64 createTime = 9;
  int64 updateTime = 10;
  int64 deleteTime = 11;
}

// 注册相关
message UnitSignUpReq {
  Unit unit = 1;
}
message UnitSignUpResp {
  Unit unit = 1;
}

// 登录相关
message UnitSignInReq {
  string authType = 1;
  string authId = 2;
  string authValue = 3;
}
message UnitSignInResp {
  string unitId = 1;
}

// 获取信息
message UnitGetInfoReq {
  string unitId = 1;
}
message UnitGetInfoResp {
  Unit unit = 1;
}

// 更新信息
message UnitUpdateInfoReq {
  Unit unit = 1;
}

// 更新密码
message UnitUpdatePasswordReq {
  string id = 1;
  string authType = 2;
  string authValue = 3;
  string newPassword = 4;
}

// 关联用户
message UnitLinkUserReq {
  string unitId = 1;
  string userId = 2;
}

// 创建并关联用户
message UnitCreateAndLinkUserReq {
  string unitId = 1;
  string codeType = 2;
  repeated User users = 3;
}
message UnitCreateAndLinkUserResp {
  int32 allCount = 1;
  int32 successCount = 2;
  int32 skipCount = 3;
}

/*Config*/
message ChatApp {
  string name = 1;
  string description = 2;
  string provider = 3;
  string appId = 4;
};

message TTSApp {
  string name = 1;
  string description = 2;
  string provider = 3;
  string appId = 4;
};

message ReportApp {
  string name = 1;
  string description = 2;
  string provider = 3;
  string appId = 4;
}

message Config {
  string unitId = 1;
  string type = 2; // chain | end2end
  ChatApp chat = 3;
  TTSApp tts = 4;
  ReportApp report = 5;
  string status = 6; // active | deleted
  int64 createTime = 7;
  int64 updateTime = 8;
}

message ConfigCreateOrUpdateReq {
  Config config = 1;
  bool admin = 2;
}

message ConfigGetByUnitIdReq {
  string unitId = 1;
  bool admin = 2;
}
message ConfigGetByUnitIdResp {
  Config config = 1;
}
